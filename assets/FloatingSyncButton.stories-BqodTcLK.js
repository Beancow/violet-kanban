import{r as o,R as j}from"./index-0yr9KlQE.js";import{u as K,a as U,b as H}from"./TempIdMapProvider-lkdMEaKn.js";import{u as O,d as V,g as y}from"./OrganizationProvider-CV2sulVi.js";import{o as T,r as G,a as z,v as q,b as L,y as E,c as Y,s as Z,u as J,e as X,n as ee,t as $,R as te,T as ae,P as ne,d as re,C as oe,A as se,f as ce}from"./mocks-CBgx2kmG.js";import{S as D}from"./index-CUsz_pzo.js";import"./index-tymuTqDW.js";import"./index-DotmK1FS.js";import"./jsx-runtime-D_zvdyIk.js";function le(){const e=K(),r=U(),t=H(),a=e.state.boards,s=r.state.lists,c=t.state.cards;return{boards:a,lists:s,cards:c}}function F(){const e=O();return{boardActionQueue:e.state.boardActionQueue,listActionQueue:e.state.listActionQueue,cardActionQueue:e.state.cardActionQueue}}const ie=["normal","start","end","both"],ue={trim:{type:"enum",className:"rt-r-lt",values:ie,responsive:!0}},de=["left","center","right"],me={align:{type:"enum",className:"rt-r-ta",values:de,responsive:!0}},pe=["wrap","nowrap","pretty","balance"],fe={wrap:{type:"enum",className:"rt-r-tw",values:pe,responsive:!0}},ge={truncate:{type:"boolean",className:"rt-truncate"}},ye=["light","regular","medium","bold"],be={weight:{type:"enum",className:"rt-r-weight",values:ye,responsive:!0}},he=["span","div","label","p"],ve=["1","2","3","4","5","6","7","8","9"],Ee={as:{type:"enum",values:he,default:"span"},...z,size:{type:"enum",className:"rt-r-size",values:ve,responsive:!0},...be,...me,...ue,...ge,...fe,...G,...T},m=o.forwardRef((e,r)=>{const{children:t,className:a,asChild:s,as:c="span",color:u,...p}=q(e,Ee,L);return o.createElement(D,{"data-accent-color":u,...p,ref:r,className:E("rt-Text",a)},s?t:o.createElement(c,null,t))});m.displayName="Text";const Re=["1","2","3"],Ce=["solid","soft","surface","outline"],Ae={...z,size:{type:"enum",className:"rt-r-size",values:Re,default:"1",responsive:!0},variant:{type:"enum",className:"rt-variant",values:Ce,default:"soft"},...Z,...T,...Y},M=o.forwardRef((e,r)=>{const{asChild:t,className:a,color:s,radius:c,...u}=q(e,Ae,L),p=t?D:"span";return o.createElement(p,{"data-accent-color":s,"data-radius":c,...u,ref:r,className:E("rt-reset","rt-Badge",a)})});M.displayName="Badge";const Ne=["div","span"],we=["none","inline","inline-block","block","contents"],xe={as:{type:"enum",values:Ne,default:"div"},...z,display:{type:"enum",className:"rt-r-display",values:we,responsive:!0}},d=o.forwardRef((e,r)=>{const{className:t,asChild:a,as:s="div",...c}=q(e,xe,J,L);return o.createElement(a?X:s,{...c,ref:r,className:E("rt-Box",t)})});d.displayName="Box";const Q=o.forwardRef(({className:e,...r},t)=>o.createElement(ee,{...r,ref:t,className:E("rt-IconButton",e)}));Q.displayName="IconButton";const Ie={content:{type:"ReactNode",required:!0},width:$.width,minWidth:$.minWidth,maxWidth:{...$.maxWidth,default:"360px"}},P=o.forwardRef((e,r)=>{const{children:t,className:a,open:s,defaultOpen:c,onOpenChange:u,delayDuration:p,disableHoverableContent:R,content:C,container:A,forceMount:b,...N}=q(e,Ie),n={open:s,defaultOpen:c,onOpenChange:u,delayDuration:p,disableHoverableContent:R};return o.createElement(te,{...n},o.createElement(ae,{asChild:!0},t),o.createElement(ne,{container:A,forceMount:b},o.createElement(re,{asChild:!0},o.createElement(oe,{sideOffset:4,collisionPadding:10,...N,asChild:!1,ref:r,className:E("rt-TooltipContent",a)},o.createElement(m,{as:"p",className:"rt-TooltipText",size:"1"},C),o.createElement(se,{className:"rt-TooltipArrow"})))))});P.displayName="Tooltip";function qe(e,r){if(e==null)return{};var t={},a=Object.keys(e),s,c;for(c=0;c<a.length;c++)s=a[c],!(r.indexOf(s)>=0)&&(t[s]=e[s]);return t}var $e=["color"],Qe=o.forwardRef(function(e,r){var t=e.color,a=t===void 0?"currentColor":t,s=qe(e,$e);return o.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s,{ref:r}),o.createElement("path",{d:"M7.14645 2.14645C7.34171 1.95118 7.65829 1.95118 7.85355 2.14645L11.8536 6.14645C12.0488 6.34171 12.0488 6.65829 11.8536 6.85355C11.6583 7.04882 11.3417 7.04882 11.1464 6.85355L8 3.70711L8 12.5C8 12.7761 7.77614 13 7.5 13C7.22386 13 7 12.7761 7 12.5L7 3.70711L3.85355 6.85355C3.65829 7.04882 3.34171 7.04882 3.14645 6.85355C2.95118 6.65829 2.95118 6.34171 3.14645 6.14645L7.14645 2.14645Z",fill:a,fillRule:"evenodd",clipRule:"evenodd"}))});const ze="_queueContainer_18f9g_2",Le="_queueList_18f9g_6",Be="_queueItem_18f9g_12",v={queueContainer:ze,queueList:Le,queueItem:Be};function W(){const{boardActionQueue:e,listActionQueue:r,cardActionQueue:t}=F(),{boards:a,lists:s,cards:c}=le(),u=o.useMemo(()=>[...e,...r,...t],[e,r,t]),{removeBoardAction:p,removeListAction:R,removeCardAction:C}=O(),[A,b]=o.useState([]);if(o.useEffect(()=>{b(V(u,a,s,c))},[u,a,s,c]),u.length===0)return React.createElement(m,null,"No pending actions.");const N=n=>{var w,x,h,l,f,g;switch(n.type){case"create-board":case"update-board":return((w=a.find(i=>i.id===y(n)))==null?void 0:w.title)||"Board";case"delete-board":case"move-board":return((x=a.find(i=>i.id===y(n)))==null?void 0:x.title)||"Board";case"create-list":case"update-list":return((h=s.find(i=>i.id===y(n)))==null?void 0:h.title)||"List";case"delete-list":case"move-list":return((l=s.find(i=>i.id===y(n)))==null?void 0:l.title)||"List";case"create-card":case"update-card":return((f=c.find(i=>i.id===y(n)))==null?void 0:f.title)||"Card";case"delete-card":case"soft-delete-card":case"restore-card":case"move-card":return((g=c.find(i=>i.id===y(n)))==null?void 0:g.title)||"Card";case"create-organization":return n.payload.name||"Organization";case"update-organization":return n.payload.data.name||"Organization";case"delete-organization":return"Organization";case"fetch-org-data":return"Fetch Org Data";case"sync-complete":return"Sync Complete";case"error":return"Error";default:return"Unknown Action"}};return React.createElement(d,{className:v.queueContainer},A.length>0&&React.createElement(d,{className:v.conflictContainer},React.createElement(m,{weight:"bold",color:"red"},"Data conflict detected!"),React.createElement("ul",null,A.map(({id:n,local:w,server:x,action:h,type:l})=>React.createElement("li",{key:n,className:v.conflictItem},React.createElement(m,null,l.charAt(0).toUpperCase()+l.slice(1)," ",React.createElement("b",null,N(h))," has conflicting changes:"),React.createElement(d,null,React.createElement(m,{size:"1"},React.createElement("b",null,"Local update:")," ",String(w.updatedAt)," (queued at"," ",h.timestamp,")",React.createElement("br",null),React.createElement("b",null,"Server update:")," ",String(x.updatedAt)),React.createElement(d,{mt:"2"},React.createElement("button",{onClick:()=>{b(f=>f.filter(g=>g.id!==n)),l==="board"&&p(n),l==="list"&&R(n),l==="card"&&C(n)}},"Keep Local"),React.createElement("button",{onClick:()=>{b(f=>f.filter(g=>g.id!==n)),l==="board"&&p(n),l==="list"&&R(n),l==="card"&&C(n)},style:{marginLeft:8}},"Keep Server"))))))),React.createElement("ul",{className:v.queueList},u.map(n=>React.createElement("li",{key:n.timestamp,className:v.queueItem},React.createElement(d,null,React.createElement(m,{weight:"bold"},N(n)),React.createElement(m,{size:"1",color:"gray",as:"p"},n.type)),React.createElement(m,{size:"1",color:"gray"},n.timestamp)))))}W.__docgenInfo={description:"",methods:[],displayName:"ActionQueue"};function B(){const[e,r]=o.useState(!1),{boardActionQueue:t,listActionQueue:a,cardActionQueue:s}=F(),c=[...t,...a,...s];return React.createElement(React.Fragment,null,React.createElement(d,{style:{position:"fixed",bottom:32,right:32,zIndex:1e3}},React.createElement(P,{content:"Show sync queue"},React.createElement(Q,{size:"3",variant:"solid",color:"blue",onClick:()=>r(!0),style:{position:"relative"}},React.createElement(Qe,null),c.length>0&&React.createElement(M,{color:"red",style:{position:"absolute",top:-8,right:-8,fontSize:12,borderRadius:"50%",padding:"2px 8px"}},c.length)))),e&&React.createElement(d,{style:{position:"fixed",top:0,right:0,width:350,height:"100%",backgroundColor:"var(--gray-2)",zIndex:1001,boxShadow:"-2px 0 5px #0000001a",display:"flex",flexDirection:"column",transition:"right .3s ease-in-out"}},React.createElement(d,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",borderBottom:"1px solid var(--gray-5)",backgroundColor:"var(--gray-3)"}},React.createElement("span",{style:{fontWeight:"bold",fontSize:18}},"Sync Queue"),React.createElement(Q,{size:"2",variant:"ghost",color:"gray",onClick:()=>r(!1)},"Ã—")),React.createElement(d,{style:{flexGrow:1,padding:"1rem",overflowY:"auto"}},React.createElement(W,null))))}B.__docgenInfo={description:"",methods:[],displayName:"FloatingSyncButton"};const Pe={title:"Components/FloatingSyncButton",component:B},I={render:()=>{const e=ce(),r=e.state.boardActionQueue.concat(e.state.listActionQueue,e.state.cardActionQueue);return r.find(t=>{var a;return((a=t.payload)==null?void 0:a.tempId)==="temp-1"})||e.enqueueBoardAction({type:"create-board",payload:{tempId:"temp-1",data:{title:"Board 1",organizationId:"org-1"}}}),r.find(t=>{var a;return((a=t.payload)==null?void 0:a.tempId)==="temp-2"})||e.enqueueListAction({type:"create-list",payload:{tempId:"temp-2",data:{title:"List 1",position:0,boardId:"",organizationId:"org-1"}}}),j.createElement(B,null)}};var S,_,k;I.parameters={...I.parameters,docs:{...(S=I.parameters)==null?void 0:S.docs,source:{originalSource:`{
  render: () => {
    // populate mock queue for the story idempotently
    const q = useMockQueue();
    const existing = q.state.boardActionQueue.concat(q.state.listActionQueue, q.state.cardActionQueue);
    if (!existing.find((a: any) => a.payload?.tempId === 'temp-1')) {
      q.enqueueBoardAction({
        type: 'create-board',
        payload: {
          tempId: 'temp-1',
          data: {
            title: 'Board 1',
            organizationId: 'org-1'
          } as any
        }
      } as any);
    }
    if (!existing.find((a: any) => a.payload?.tempId === 'temp-2')) {
      q.enqueueListAction({
        type: 'create-list',
        payload: {
          tempId: 'temp-2',
          data: {
            title: 'List 1',
            position: 0,
            boardId: '',
            organizationId: 'org-1'
          } as any
        }
      } as any);
    }
    return <FloatingSyncButton />;
  }
}`,...(k=(_=I.parameters)==null?void 0:_.docs)==null?void 0:k.source}}};const We=["Default"];export{I as Default,We as __namedExportsOrder,Pe as default};
