import{r as reactExports,R as React}from"./index-0yr9KlQE.js";var define_process_env_default={};const CLIENT_DISABLED=typeof process<"u"&&(define_process_env_default.NEXT_PUBLIC_DISABLE_SENTRY==="1"||define_process_env_default.NEXT_PUBLIC_DISABLE_SENTRY==="true"),SERVER_DISABLED=typeof process<"u"&&(define_process_env_default.DISABLE_SENTRY==="1"||define_process_env_default.DISABLE_SENTRY==="true");let realSentry=null,attemptedLoad=!1;function loadSentryIfServer(){if(!attemptedLoad)if(attemptedLoad=!0,typeof window>"u"&&!SERVER_DISABLED&&!CLIENT_DISABLED)try{const req=eval("require");realSentry=req("@sentry/nextjs")}catch(e){console.debug("[sentry] failed to load @sentry/nextjs",e),realSentry=null}else realSentry=null}const captureException=e=>{if(loadSentryIfServer(),realSentry&&typeof realSentry.captureException=="function")return realSentry.captureException(e);console.debug("[sentry] captureException (disabled)",e)};var NOTHING=Symbol.for("immer-nothing"),DRAFTABLE=Symbol.for("immer-draftable"),DRAFT_STATE=Symbol.for("immer-state");function die(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var getPrototypeOf=Object.getPrototypeOf;function isDraft(e){return!!e&&!!e[DRAFT_STATE]}function isDraftable(e){var t;return e?isPlainObject(e)||Array.isArray(e)||!!e[DRAFTABLE]||!!((t=e.constructor)!=null&&t[DRAFTABLE])||isMap(e)||isSet(e):!1}var objectCtorString=Object.prototype.constructor.toString();function isPlainObject(e){if(!e||typeof e!="object")return!1;const t=getPrototypeOf(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===objectCtorString}function each(e,t){getArchtype(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function getArchtype(e){const t=e[DRAFT_STATE];return t?t.type_:Array.isArray(e)?1:isMap(e)?2:isSet(e)?3:0}function has(e,t){return getArchtype(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function set(e,t,r){const n=getArchtype(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function is(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function isMap(e){return e instanceof Map}function isSet(e){return e instanceof Set}function latest(e){return e.copy_||e.base_}function shallowCopy(e,t){if(isMap(e))return new Map(e);if(isSet(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=isPlainObject(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[DRAFT_STATE];let i=Reflect.ownKeys(n);for(let o=0;o<i.length;o++){const s=i[o],a=n[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[s]})}return Object.create(getPrototypeOf(e),n)}else{const n=getPrototypeOf(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function freeze(e,t=!1){return isFrozen(e)||isDraft(e)||!isDraftable(e)||(getArchtype(e)>1&&(e.set=e.add=e.clear=e.delete=dontMutateFrozenCollections),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>freeze(n,!0))),e}function dontMutateFrozenCollections(){die(2)}function isFrozen(e){return Object.isFrozen(e)}var plugins={};function getPlugin(e){const t=plugins[e];return t||die(0,e),t}var currentScope;function getCurrentScope(){return currentScope}function createScope(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function usePatchesInScope(e,t){t&&(getPlugin("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function revokeScope(e){leaveScope(e),e.drafts_.forEach(revokeDraft),e.drafts_=null}function leaveScope(e){e===currentScope&&(currentScope=e.parent_)}function enterScope(e){return currentScope=createScope(currentScope,e)}function revokeDraft(e){const t=e[DRAFT_STATE];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function processResult(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[DRAFT_STATE].modified_&&(revokeScope(t),die(4)),isDraftable(e)&&(e=finalize(t,e),t.parent_||maybeFreeze(t,e)),t.patches_&&getPlugin("Patches").generateReplacementPatches_(r[DRAFT_STATE].base_,e,t.patches_,t.inversePatches_)):e=finalize(t,r,[]),revokeScope(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==NOTHING?e:void 0}function finalize(e,t,r){if(isFrozen(t))return t;const n=t[DRAFT_STATE];if(!n)return each(t,(i,o)=>finalizeProperty(e,n,t,i,o,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return maybeFreeze(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let o=i,s=!1;n.type_===3&&(o=new Set(i),i.clear(),s=!0),each(o,(a,c)=>finalizeProperty(e,n,i,a,c,r,s)),maybeFreeze(e,i,!1),r&&e.patches_&&getPlugin("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function finalizeProperty(e,t,r,n,i,o,s){if(isDraft(i)){const a=o&&t&&t.type_!==3&&!has(t.assigned_,n)?o.concat(n):void 0,c=finalize(e,i,a);if(set(r,n,c),isDraft(c))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(isDraftable(i)&&!isFrozen(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;finalize(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&maybeFreeze(e,i)}}function maybeFreeze(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&freeze(t,r)}function createProxyProxy(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,o=objectTraps;r&&(i=[n],o=arrayTraps);const{revoke:s,proxy:a}=Proxy.revocable(i,o);return n.draft_=a,n.revoke_=s,a}var objectTraps={get(e,t){if(t===DRAFT_STATE)return e;const r=latest(e);if(!has(r,t))return readPropFromProto(e,r,t);const n=r[t];return e.finalized_||!isDraftable(n)?n:n===peek(e.base_,t)?(prepareCopy(e),e.copy_[t]=createProxy(n,e)):n},has(e,t){return t in latest(e)},ownKeys(e){return Reflect.ownKeys(latest(e))},set(e,t,r){const n=getDescriptorFromProto(latest(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=peek(latest(e),t),o=i==null?void 0:i[DRAFT_STATE];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(is(r,i)&&(r!==void 0||has(e.base_,t)))return!0;prepareCopy(e),markChanged(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return peek(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,prepareCopy(e),markChanged(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=latest(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){die(11)},getPrototypeOf(e){return getPrototypeOf(e.base_)},setPrototypeOf(){die(12)}},arrayTraps={};each(objectTraps,(e,t)=>{arrayTraps[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});arrayTraps.deleteProperty=function(e,t){return arrayTraps.set.call(this,e,t,void 0)};arrayTraps.set=function(e,t,r){return objectTraps.set.call(this,e[0],t,r,e[0])};function peek(e,t){const r=e[DRAFT_STATE];return(r?latest(r):e)[t]}function readPropFromProto(e,t,r){var i;const n=getDescriptorFromProto(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function getDescriptorFromProto(e,t){if(!(t in e))return;let r=getPrototypeOf(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=getPrototypeOf(r)}}function markChanged(e){e.modified_||(e.modified_=!0,e.parent_&&markChanged(e.parent_))}function prepareCopy(e){e.copy_||(e.copy_=shallowCopy(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Immer2=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const o=r;r=t;const s=this;return function(c=o,...u){return s.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&die(6),n!==void 0&&typeof n!="function"&&die(7);let i;if(isDraftable(t)){const o=enterScope(this),s=createProxy(t,void 0);let a=!0;try{i=r(s),a=!1}finally{a?revokeScope(o):leaveScope(o)}return usePatchesInScope(o,n),processResult(i,o)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===NOTHING&&(i=void 0),this.autoFreeze_&&freeze(i,!0),n){const o=[],s=[];getPlugin("Patches").generateReplacementPatches_(t,i,o,s),n(o,s)}return i}else die(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...a)=>this.produceWithPatches(s,c=>t(c,...a));let n,i;return[this.produce(t,r,(s,a)=>{n=s,i=a}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){isDraftable(e)||die(8),isDraft(e)&&(e=current(e));const t=enterScope(this),r=createProxy(e,void 0);return r[DRAFT_STATE].isManual_=!0,leaveScope(t),r}finishDraft(e,t){const r=e&&e[DRAFT_STATE];(!r||!r.isManual_)&&die(9);const{scope_:n}=r;return usePatchesInScope(n,t),processResult(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=getPlugin("Patches").applyPatches_;return isDraft(e)?n(e,t):this.produce(e,i=>n(i,t))}};function createProxy(e,t){const r=isMap(e)?getPlugin("MapSet").proxyMap_(e,t):isSet(e)?getPlugin("MapSet").proxySet_(e,t):createProxyProxy(e,t);return(t?t.scope_:getCurrentScope()).drafts_.push(r),r}function current(e){return isDraft(e)||die(10,e),currentImpl(e)}function currentImpl(e){if(!isDraftable(e)||isFrozen(e))return e;const t=e[DRAFT_STATE];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=shallowCopy(e,t.scope_.immer_.useStrictShallowCopy_)}else r=shallowCopy(e,!0);return each(r,(n,i)=>{set(r,n,currentImpl(i))}),t&&(t.finalized_=!1),r}var immer=new Immer2,produce=immer.produce;immer.produceWithPatches.bind(immer);immer.setAutoFreeze.bind(immer);immer.setUseStrictShallowCopy.bind(immer);immer.applyPatches.bind(immer);immer.createDraft.bind(immer);immer.finishDraft.bind(immer);function registerBoardAdapter(e){}function registerListAdapter(e){}function registerCardAdapter(e){}function registerQueueAdapter(e){}function detectActionConflicts(e,t,r,n){const i=[];return e.forEach(o=>{const s=hasPayload(o)?o.payload:void 0;if(s&&isObject(s)&&"data"in s&&isObject(s.data)&&s.data,o.type==="update-board"&&isSyncActionWithData(o)){const a=o.payload.data,c=t.find(f=>f.id===a.id),u=extractUpdatedAt(a.updatedAt),d=c?extractUpdatedAt(c.updatedAt):void 0;c&&u&&d&&u!==d&&i.push({id:a.id,local:a,server:c,action:o,type:"board"})}else if(o.type==="update-list"&&isSyncActionWithData(o)){const a=o.payload.data,c=r.find(f=>f.id===a.id),u=extractUpdatedAt(a.updatedAt),d=c?extractUpdatedAt(c.updatedAt):void 0;c&&u&&d&&u!==d&&i.push({id:a.id,local:a,server:c,action:o,type:"list"})}else if(o.type==="update-card"&&isSyncActionWithData(o)){const a=o.payload.data,c=n.find(f=>f.id===a.id),u=extractUpdatedAt(a.updatedAt),d=c?extractUpdatedAt(c.updatedAt):void 0;c&&u&&d&&u!==d&&i.push({id:a.id,local:a,server:c,action:o,type:"card"})}}),i}function isObject(e){return typeof e=="object"&&e!==null}function hasPayload(e){return"payload"in e&&e.payload!==void 0}function payloadIsRecord(e){return isObject(e)}function hasIdField(e){return isObject(e)&&typeof e.id=="string"}function hasTempIdField(e){return isObject(e)&&typeof e.tempId=="string"}function isSyncActionWithData(e){if(!hasPayload(e))return!1;const t=e.payload;return payloadIsRecord(t)?"data"in t&&isObject(t.data):!1}function extractUpdatedAt(e){if(e){if(e instanceof Date)return e.toISOString();if(typeof e=="string")return e}}function getActionItemId(e){if(!hasPayload(e))return;const t=e.payload;if(!payloadIsRecord(t))return;const r=t;if("data"in r&&isObject(r.data)){const n=r.data;if(hasIdField(n))return n.id;if(hasTempIdField(n))return n.tempId}if(hasIdField(r))return r.id;if(hasTempIdField(r))return r.tempId}function squashQueueActions(e,t){const r=getActionItemId(t),n=t.type;return[...e.filter(o=>{const s=getActionItemId(o);return!(s&&r&&s===r&&o.type===n)}),t]}function reducer$1(e,t){return produce(e,r=>{switch(t.type){case"ENQUEUE_BOARD":r.boardActionQueue=squashQueueActions(r.boardActionQueue,t.action);return;case"ENQUEUE_LIST":r.listActionQueue=squashQueueActions(r.listActionQueue,t.action);return;case"ENQUEUE_CARD":r.cardActionQueue=squashQueueActions(r.cardActionQueue,t.action);return;case"REMOVE_BOARD_BY_ID":r.boardActionQueue=r.boardActionQueue.filter(n=>getActionItemId(n)!==t.itemId);return;case"REMOVE_LIST_BY_ID":r.listActionQueue=r.listActionQueue.filter(n=>getActionItemId(n)!==t.itemId);return;case"REMOVE_CARD_BY_ID":r.cardActionQueue=r.cardActionQueue.filter(n=>getActionItemId(n)!==t.itemId);return;case"SET_STATE":return t.state}})}const STORAGE_KEY="violet-kanban-queue-storage",QueueContext=reactExports.createContext(null);function QueueProvider({children:e}){let t={boardActionQueue:[],listActionQueue:[],cardActionQueue:[]};try{if(typeof window<"u"){const o=window.localStorage.getItem(STORAGE_KEY);o&&(t=JSON.parse(o))}}catch(o){console.error("[queue] failed to read from localStorage",o);try{captureException(o)}catch{}t={boardActionQueue:[],listActionQueue:[],cardActionQueue:[]}}const[r,n]=reactExports.useReducer(reducer$1,t);reactExports.useEffect(()=>{try{window.localStorage.setItem(STORAGE_KEY,JSON.stringify(r))}catch(o){console.error("[queue] failed to write to localStorage",o);try{captureException(o)}catch{}}},[r]);const i={state:r,enqueueBoardAction:o=>n({type:"ENQUEUE_BOARD",action:o}),enqueueListAction:o=>n({type:"ENQUEUE_LIST",action:o}),enqueueCardAction:o=>n({type:"ENQUEUE_CARD",action:o}),removeBoardAction:o=>n({type:"REMOVE_BOARD_BY_ID",itemId:o}),removeListAction:o=>n({type:"REMOVE_LIST_BY_ID",itemId:o}),removeCardAction:o=>n({type:"REMOVE_CARD_BY_ID",itemId:o})};return reactExports.useEffect(()=>(i.enqueueBoardAction,i.enqueueListAction,i.enqueueCardAction,()=>void 0),[r]),React.createElement(QueueContext.Provider,{value:i},e)}function useQueues(){const e=reactExports.useContext(QueueContext);if(!e)throw new Error("useQueues must be used within QueueProvider");return e}QueueProvider.__docgenInfo={description:"",methods:[],displayName:"QueueProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}}};const initialState={organizations:[],loading:!0,currentOrganizationId:null};function reducer(e,t){switch(t.type){case"SET_ORGANIZATIONS":return{...e,organizations:t.orgs};case"SET_LOADING":return{...e,loading:t.loading};case"SET_CURRENT_ORG_ID":return{...e,currentOrganizationId:t.id};default:return e}}const OrganizationContext=reactExports.createContext(null);function OrganizationProvider({children:e}){const[t,r]=reactExports.useReducer(reducer,initialState),n={organizations:t.organizations,loading:t.loading,currentOrganizationId:t.currentOrganizationId,currentOrganization:t.organizations.find(i=>i.id===t.currentOrganizationId)??null,setCurrentOrganizationId:i=>r({type:"SET_CURRENT_ORG_ID",id:i}),setOrganizations:i=>r({type:"SET_ORGANIZATIONS",orgs:i}),setLoading:i=>r({type:"SET_LOADING",loading:i}),refetchOrganizations:async()=>{}};return React.createElement(OrganizationContext.Provider,{value:n},e)}function useOrganizationProvider(){const e=reactExports.useContext(OrganizationContext);if(!e)throw new Error("useOrganizationProvider must be used within OrganizationProvider");return e}OrganizationProvider.__docgenInfo={description:"",methods:[],displayName:"OrganizationProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}}};export{OrganizationProvider as O,QueueProvider as Q,registerListAdapter as a,registerCardAdapter as b,captureException as c,detectActionConflicts as d,useOrganizationProvider as e,getActionItemId as g,produce as p,registerBoardAdapter as r,useQueues as u};
